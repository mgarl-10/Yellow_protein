Figure 7. Yellow protects Stammera from dessication during extracellular transmission.


Figure 7C. Stammera titers in eggs from females during the first two weeks post-injection under both control and low humidity conditions

library(dplyr)
library(MASS)     
library(multcomp)   
library(car)
library(ggplot2)

my_data <- read.table("sym_titers_dehy_Ed9.txt", header = TRUE)

my_data <- my_data %>%
  mutate(
    Condition.f = factor(Condition),   
    Treatment.f = factor(Treatment)
  )


# Control

ctl_Ed9 <- my_data %>% filter(Condition.f == "CTL")

mean(ctl_Ed9$copy_number); var(ctl_Ed9$copy_number); var(ctl_Ed9$copy_number)/mean(ctl_Ed9$copy_number)

m_pois_ctl <- glm(copy_number ~ Treatment.f, data = ctl_Ed9, family = poisson(link="log"))
m_nb_ctl   <- glm.nb(copy_number ~ Treatment.f, data = ctl_Ed9)

AIC(m_pois_ctl); AIC(m_nb_ctl)
summary(m_nb_ctl)

exp(coef(m_nb_ctl))
exp(confint(m_nb_ctl))


# GFP

gfp_Ed9 <- my_data %>% filter(Condition.f == "GFP")

mean(gfp_Ed9$copy_number)
var(gfp_Ed9$copy_number)
var(gfp_Ed9$copy_number)/mean(gfp_Ed9$copy_number)

m_pois_gfp <- glm(copy_number ~ Treatment.f, data = gfp_Ed9, family = poisson(link="log"))
m_nb_gfp   <- glm.nb(copy_number ~ Treatment.f, data = gfp_Ed9)

AIC(m_pois_gfp); AIC(m_nb_gfp)
summary(m_nb_gfp)

exp(coef(m_nb_gfp))
exp(confint(m_nb_gfp))

# yellow treatment

yell_Ed9 <- my_data %>% filter(Condition.f == "YELL")

mean(yell_Ed9$copy_number)
var(yell_Ed9$copy_number)
var(yell_Ed9$copy_number)/mean(yell_Ed9$copy_number)

m_pois_yell <- glm(copy_number ~ Treatment.f, data = yell_Ed9, family = poisson(link="log"))
m_nb_yell   <- glm.nb(copy_number ~ Treatment.f, data = yell_Ed9)

AIC(m_pois_yell); AIC(m_nb_yell)
summary(m_nb_yell)


exp(coef(m_nb_yell))
exp(confint(m_nb_yell))


# Plotting

my_data$Treatment <- factor(my_data$Treatment,
                            levels = c("untreated", "low_hum"))


p <-ggplot(my_data, aes(x = Condition, y = copy_number, fill = Treatment)) +
  geom_boxplot(
    outlier.shape = NA,
    color = "black",
    width = 0.6,
    position = position_dodge(0.75)
  ) +
  scale_y_log10(
    limits = c(1e2, 1e7),
    breaks = 10^(2:7),
    labels = scales::trans_format("log10", scales::math_format(10^.x))
  ) +
  scale_fill_manual(values = c(
    "untreated" = "#A5A5A5",
    "low_hum"   = "#FFFFFF"
  )) +
  labs(
    x = "Condition",
    y = "Stammera abundance in egg caplets"
  ) +
  theme_minimal() +
  theme(
    legend.position = "top",
    axis.text.x = element_text(angle = 0, hjust = 0.5, size = 12),
    text = element_text(size = 14),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_rect(color = "black", fill = NA)
  ) +
  geom_vline(
    xintercept = seq(1.5, length(unique(my_data$Condition)) - 0.5, by = 1),
    linetype = "dotted",
    color = "black"
  )


ggsave("Fig7C_sym_abundance_low_hum.pdf", p)
ggsave("Fig7C_sym_abundance_low_humt.svg", p)

